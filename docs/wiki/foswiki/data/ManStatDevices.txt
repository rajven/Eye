%META:TOPICINFO{author="roman" comment="reprev" date="1603101574" format="1.1" reprev="2" version="2"}%
%META:TOPICPARENT{name="ManStatCommonSovtestLocal"}%
---+!! Сетевая инфраструктура

Раздел был создан для контроля подключения ip-адресов по портам оборудования. Имеется список устройств и их портов, между которыми задаются связи. Необходимо обязательно указать какой порт одного свича соединён с каким портом другого свича.
В дальнейшем, скрипт опрашивает роутеры и свичи по snmp и ищет маки по портам устройств.

---++ Конфигурация устройства, пункт Параметры

     <img src="%ATTACHURLPATH%/device_settings.png" alt="device_settings.png" width='763' height='385' />

Обязательные поля:

   * Название, IP - имя и адрес устройства
   * Портов - сколько портов. 
   * Вендор - кто производитель устройства
   * "Snmp Version" - использовать ли snmp и какой версии. Для неуправляемых свичей надо выключать! 
   * "Snmp * Community" - доступ по snmp v2/1 к свичу по snmp. v3 в настоящий момент не используется.
Дополнительные поля:
   * Модель - модель устройства
   * Расположен - географическое местоположение
   * "Шлюз в интернет" - является ли маршрутизатором в интернет. Применяется для конфигурации списков доступа
   * Роутер - является ли обычным маршрутизатором. Используется скриптом сканирования для анализа arp-кэша
   * DHCP-Server - работает ли на нём dhcp-сервер. Имеет смысл только для устройств Микротик
   * Шейперы - Включать ли управление полосой пропускания для клиентов шлюза
   * "Только connected юзеры" - Конфигурировать ли на шлюзе всех известных системе клиентов или только тех, кто принадлежит сетям, непосредственно терминируемых этим шлюзом. Другими словами, если за шлюзом есть ещё роутеры - выпускать ли и их сети.
   * fdb by snmp - мак-таблица отдаётся не по номеру порта, а по snmp-индексу (надо бы убрать...)
   * Discovery - обрабатывать ли устройство при сканировании сети
   * Nagios - включать ли мониторинг для устройства и его клиентов
   * Auth user - запись в списке юзеров, принадлежащая устройству. Используется в анализе логов при отборе по источнику.

---++ Порты

Здесь удобнее всего смотреть кто подключен на портах и менять связи устройства с другими свичами

---++ Состояние

Здесь отображается текущее состояние портов свича по snmp. Также можно включить/выключить порт если указана community на запись.
Остальной функционал тот же, что и на вкладке Порты. Вынесено отдельно, поскольку опрос свича может занимать продолжительное время, а просто посмотреть, кто у нас тут на порту и ждать при этом хочется не особо.



-- Main.RomanDmitriev - 17 Oct 2020


%META:FILEATTACHMENT{name="device_settings.png" attachment="device_settings.png" attr="" comment="Конфигурация устройства" date="1602964541" path="device_settings.png" size="39626" user="roman" version="1"}%
%META:PREFERENCE{name="ALLOWTOPICCHANGE" title="ALLOWTOPICCHANGE" type="Set" value="AdminGroup"}%
%META:PREFERENCE{name="PERMSET_CHANGE" title="PERMSET_CHANGE" type="Local" value="details"}%
%META:PREFERENCE{name="PERMSET_CHANGE_DETAILS" title="PERMSET_CHANGE_DETAILS" type="Local" value="AdminGroup"}%
