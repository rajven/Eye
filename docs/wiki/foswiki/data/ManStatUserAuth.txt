%META:TOPICINFO{author="roman" comment="reprev" date="1613031460" format="1.1" reprev="1" version="5"}%
%META:TOPICPARENT{name="ManStatCommonSovtestLocal"}%
---+!! Настройки параметров доступа для клиентов

В системе есть одна предустановленная запись клиента - default. К этому клиенту попадают ВСЕ новые адреса в сети, как выданные dhcp-сервером, так и найденные скриптом сканирования или добавленные после анализа трафика netflow со шлюза организации.

Из этого правила есть два исключения - хотспот и явно указанное правило принадлежности к сети для пользователя.
Все сети, помеченные в Настройках как принадлежащие к хот-споту автоматически добавляются к записи, указанной в настройках как основная для хотспота (если привязки нет, клиенты будут добавляться с клиенту по умолчанию - default).
Явное указание принадлежности указывается в поле Rule в виде cidr-нотации сети, т.е. типа 192.168.xxx.0/24

   * Параметры для юзера: <br />
     <img src="%ATTACHURLPATH%/User_settings.png" alt="User_settings.png" width='895' height='360' />

Остальные поля формы:
   * "Активен" разрешает или запрещает работу всем Ip-адресам, привязанным к этому клиенту. Однако, возможно сделать выборочное выключение, если клиенту работа разрешена, а у конкретного ip-адреса доступ может быть запрещён.
   * "Блок по трафику" - индикатор того, что пользователь превысил выданный ему лимит трафика. Для снятия блокировки надо снять это поле и увеличить лимит, по кторому клиент на неё влетел
   * "Фильтр" и "Шейпер" - это информационные поля, указывающие с какими настройками по умолчанию будут привязываться/создаваться ip в списке этого клиента.
   * "В день, Mb" и "В месяц, Mb" - лимиты по трафику для юзера. Лимит суммарный для всех адресов клиента. Если персональные настройки для каждого ip перекрывают этот параметр, действовать всё равно будет он!

В этом же блоке на форме также присутствует информация о дате создания этой записи и кнопка просмотра статистки по этому клиенту.

Дальше расположена форма работы с списком адресов клиента. Она позволяет для выделенных адресов:
   * установить режим работы, фильтр, шейпер, лимиты.
   * переместить выделенные ip-адреса к другому юзеру (клиенту).
   * Из выделенных адресов создать отдельного клиента (для каждой записи - своего) базируясь на поле "DNS name", Комментарий.
   * удалить выделенные ip-адреса

Замечание:
   1 удаление записи ip-адреса выполняется полностью только в случае, если на этом адресе не было зарегистрировано трафика. Если трафик был - запись будет помечена как удалённая, но останется в базе данных и может быть как просмотрена по своему идентификатору, так и восстановлена
   2 Клиенту Default нельзя включить интернет. 
   3 Ip-адреса, принадлежащие клиенту Default рассматриваются как времененные и НЕ ПОПАДАЮТ в список статических адресов для конфигурации DHCP-сервера. Все ip-адреса, для которых включена опция DHCP, попадают в статические привязки dhcp-сервера, за исключением указанных выше (и клиента хот-спота).

п.2. и п.3 сделано, чтобы не допустить выхода в интернет неизвестных машин. Если ip-адресу нужен интернет - будьте любезны достать его из дефалта (либо переместив к какому-то юзеру, либо сделав нового), что автоматически означает создание для него статической привязки в DHCP.

-- Main.RomanDmitriev - 17 Oct 2020



%META:FILEATTACHMENT{name="User_settings.png" attachment="User_settings.png" attr="" comment="Параметры для юзера" date="1602957863" path="User_settings.png" size="52120" user="roman" version="1"}%
%META:PREFERENCE{name="ALLOWTOPICCHANGE" title="ALLOWTOPICCHANGE" type="Set" value="AdminGroup"}%
%META:PREFERENCE{name="PERMSET_CHANGE" title="PERMSET_CHANGE" type="Local" value="details"}%
%META:PREFERENCE{name="PERMSET_CHANGE_DETAILS" title="PERMSET_CHANGE_DETAILS" type="Local" value="AdminGroup"}%
